From 2db8dfe4b9baf5eb4c32a55bd20a7c41b21c0515 Mon Sep 17 00:00:00 2001
From: Steve Pfetsch <spfetsch@google.com>
Date: Fri, 03 Feb 2017 22:05:17 +0100
Subject: [PATCH] drivers: video: Add bounds checking in fb_cmap_to_user

Verify that unsigned int value will not become negative before cast to
signed int.

Bug: 31651010
Change-Id: I548a200f678762042617f11100b6966a405a3920
---

diff --git a/drivers/video/fbcmap.c b/drivers/video/fbcmap.c
index f26570d..2a358ae 100644
--- a/drivers/video/fbcmap.c
+++ b/drivers/video/fbcmap.c
@@ -196,7 +196,7 @@
 	int tooff = 0, fromoff = 0;
 	int size;
 
-	if (!to || !from)
+	if (!to || !from || (int)(to->start) < 0)
 		return -EINVAL;
 
 	if (to->start > from->start)
